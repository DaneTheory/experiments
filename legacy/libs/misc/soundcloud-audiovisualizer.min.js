var SoundCloudAudioSource=function(t){var e,r=this,a=new(window.AudioContext||window.webkitAudioContext);e=a.createAnalyser(),e.fftSize=256;var s=a.createMediaElementSource(t);s.connect(e),e.connect(a.destination);var i=function(){e.getByteFrequencyData(r.streamData);for(var t=0,a=0;64>a;a++)t+=r.streamData[a];r.volume=t;for(var s=0,a=0;31>a;a++)s+=r.streamData[a];r.volumeLow=s;for(var i=0,a=31;64>a;a++)i+=r.streamData[a];r.volumeHi=i};setInterval(i,20),this.volume=0,this.volumeLow=0,this.volumeHi=0,this.streamData=new Uint8Array(256),this.playStream=function(e){t.addEventListener("ended",function(){r.directStream("coasting")}),t.setAttribute("src",e),t.play()}},Visualizer=function(){var t;this.init=function(e){t=e.audioSource;document.getElementById(e.containerId)}},SoundcloudLoader=function(t){var e=this,r="7ff7507da281c083017c7ffb499b1955";this.sound={},this.streamUrl="",this.errorMessage="",this.player=t,this.loadStream=function(t,a,s){SC.initialize({client_id:r}),SC.get("/resolve",{url:t},function(t){if(t.errors){e.errorMessage="";for(var i=0;i<t.errors.length;i++)e.errorMessage+=t.errors[i].error_message+"<br>";e.errorMessage+="Make sure the URL has the correct format: https://soundcloud.com/user/title-of-the-track",s()}else"playlist"==t.kind?(e.sound=t,e.streamPlaylistIndex=0,e.streamUrl=function(){return t.tracks[e.streamPlaylistIndex].stream_url+"?client_id="+r},a()):(e.sound=t,e.streamUrl=function(){return t.stream_url+"?client_id="+r},a())})},this.directStream=function(t){"toggle"==t?this.player.paused?this.player.play():this.player.pause():"playlist"==this.sound.kind&&("coasting"==t?this.streamPlaylistIndex++:"forward"==t?this.streamPlaylistIndex>=this.sound.track_count-1?this.streamPlaylistIndex=0:this.streamPlaylistIndex++:this.streamPlaylistIndex<=0?this.streamPlaylistIndex=this.sound.track_count-1:this.streamPlaylistIndex--,this.streamPlaylistIndex>=0&&this.streamPlaylistIndex<=this.sound.track_count-1&&(this.player.setAttribute("src",this.streamUrl()),this.player.play()))}},visualizer=new Visualizer,player=document.getElementById("player"),loader=new SoundcloudLoader(player),audioSource=new SoundCloudAudioSource(player),form=document.getElementById("form"),loadAndUpdate=function(t){loader.loadStream(t,function(){audioSource.playStream(loader.streamUrl())},function(){})};if(visualizer.init({containerId:"visualizer",audioSource:audioSource}),window.location.hash){var trackUrl="https://soundcloud.com/"+window.location.hash.substr(1);loadAndUpdate(trackUrl)}else{var trackUrl="https://soundcloud.com/sterlingmoss/chris-liberator-sterling-moss-live-set-april-2013";loadAndUpdate(trackUrl)}